# 프론트 추가 정리 리팩토링 계획

## 배경/문제
- Entry/Reply 관련 mutation 로직이 HomeFeed와 ThreadDetailPage에 중복되어 유지보수가 어렵다.
- autosize textarea 패턴이 여러 컴포넌트에 반복되어 UI 일관성이 깨질 수 있다.
- 카드/버튼 등의 스타일 클래스 문자열이 컴포넌트마다 흩어져 변경 비용이 크다.
- React Query 캐시 업데이트(setQueryData) 로직이 HomeFeed에 집중되어 있어 재사용성이 낮다.

## 목표
- Entry/Reply 액션을 공통 훅으로 묶어 중복을 줄인다.
- autosize textarea 컴포넌트를 공통화해 UI/동작을 통일한다.
- 스타일 토큰을 상수화해 일관된 스타일 관리를 가능하게 한다.
- 캐시 업데이트 유틸을 도입해 쿼리 업데이트 로직을 정리한다.

## 범위
- 포함
  - `useEntryActions` 훅 작성 및 HomeFeed/ThreadDetailPage 적용
  - `AutosizeTextarea` 공통 컴포넌트 도입
  - 주요 카드/버튼 스타일 토큰 상수화
  - 캐시 업데이트 유틸 함수 도입 및 HomeFeed 적용
- 제외
  - UI 전면 재디자인
  - 백엔드 API 변경
  - 상태 관리 라이브러리 교체

## 현재 동작 정리
- HomeFeed와 ThreadDetailPage에서 entry/reply mutation이 유사 패턴으로 반복됨.
- `EntryEditor`, `ReplyComposer`, `ThreadEditor`에서 autosize textarea 구성이 중복됨.
- 테마/버튼 클래스가 각 컴포넌트에 분산되어 관리가 어려움.
- 캐시 업데이트가 HomeFeed에만 존재하여 재사용 불가.

## 개선 방향
- entry/reply mutation과 공통 invalidation을 훅으로 묶어 호출부를 단순화한다.
- autosize textarea를 공통 컴포넌트로 분리해 재사용성을 높인다.
- 스타일 토큰을 상수로 분리해 변경 범위를 축소한다.
- 캐시 업데이트는 유틸 함수로 묶어 테스트/재사용을 용이하게 한다.

## 단계별 계획
- Phase 1: Entry/Reply 액션 훅
  - `useEntryActions` 훅 도입
  - HomeFeed/ThreadDetailPage에서 훅 사용
  - 완료 기준: entry/reply mutation 중복 제거
- Phase 2: AutosizeTextarea 공통화
  - `AutosizeTextarea` 컴포넌트 추가
  - EntryEditor/ReplyComposer/ThreadEditor에서 교체
  - 완료 기준: autosize textarea 중복 제거
- Phase 3: 스타일 토큰 상수화
  - 카드/버튼 클래스 토큰 파일 생성
  - 주요 컴포넌트에서 토큰 사용
  - 완료 기준: 스타일 문자열 중복 감소
- Phase 4: 캐시 업데이트 유틸
  - thread cache update 유틸 추가
  - HomeFeed에서 유틸 사용
  - 완료 기준: setQueryData 중복 제거

## 리스크 및 대응
- 공통 훅 도입으로 인한 props/옵션 증가 가능
  - 대응: 최소 옵션만 노출하고 기본값 제공
- 스타일 토큰 상수화로 클래스 적용 누락 가능
  - 대응: 변경 대상 컴포넌트 단위로 검증

## 검증 계획
- HomeFeed/ThreadDetailPage에서 entry/reply 작성/수정/삭제 동작 확인
- autosize textarea 동작(입력 시 높이 증가) 확인
- 카드/버튼 스타일 시각 확인
- 피드 캐시 업데이트 후 목록 반영 확인
