# 스레드 테이블/스키마/권한 분석 계획

## 배경/문제
- 프로젝트의 테이블 수가 적절한지, 스키마 정의가 합리적인지 판단할 근거가 필요하다.
- 사용자 간 권한 분리가 제대로 되어 있는지(예: 다른 사용자의 스레드 호출 차단) 확인이 필요하다.

## 목표
- 현재 데이터 모델의 테이블 수와 책임 분리를 평가하고 개선 필요 여부를 제시한다.
- 주요 테이블 스키마(필드, 제약, 인덱스)의 적절성을 점검한다.
- API 레벨에서 사용자 간 접근 통제가 올바르게 동작하는지 확인한다.
- 결과를 문서로 정리해 리스크와 개선안을 제시한다.

## 범위
- 포함: 백엔드 ORM/마이그레이션/SQL 스키마, 관련 도메인 모델, 스레드 조회/수정 API, 인증/인가 미들웨어
- 제외: 성능 최적화 세부 튜닝(쿼리 플랜 기반), 인프라 레벨 보안 설정(WAF, 네트워크 ACL)

## 현재 동작 정리
- 데이터 모델 정의 위치(ORM 모델/마이그레이션/SQL)와 스키마 생성 흐름을 파악한다.
- 스레드 관련 API 엔드포인트와 권한 체크 위치(미들웨어/서비스 레이어)를 확인한다.

## 개선 방향
- 테이블은 “도메인 경계” 기준으로 나눠져 있는지, 중복/결합 과다 여부를 평가한다.
- 스키마는 무결성(외래키/유니크/NOT NULL)과 조회 패턴(인덱스) 관점에서 적절성 확인.
- API는 “인증 + 소유권(ownership) 검증”이 모든 접근 경로에 일관되게 적용되는지 확인.

## 단계별 계획
- 1단계: 스키마/모델 소스 파악
  - 무엇을 변경: 없음(분석만)
  - 완료 기준: 테이블 목록, 주요 테이블 간 관계, 스키마 정의 파일 위치 목록화
- 2단계: 테이블 수/스키마 적절성 점검
  - 무엇을 변경: 없음(분석만)
  - 완료 기준: 각 테이블 책임, 정규화/비정규화 판단, 제약/인덱스 점검 결과 정리
- 3단계: API 권한 분리 점검
  - 무엇을 변경: 없음(분석만)
  - 완료 기준: 스레드 접근 API별 인증/인가 흐름 다이어그램 및 취약 가능 지점 정리
- 4단계: 결과 문서화
  - 무엇을 변경: 분석 결과 문서 작성
  - 완료 기준: 테이블/스키마 평가, 권한 분리 평가, 개선 제안 포함 문서 완료

## 리스크 및 대응
- 스키마가 여러 위치에 분산되어 있을 경우 누락 위험 → 모델/마이그레이션/SQL을 모두 확인
- 권한 로직이 공통 미들웨어와 개별 서비스에 혼재될 가능성 → 호출 경로 추적 기준을 명확화

## 검증 계획
- 정적 분석: 코드/스키마 정의 파일 검토
- 수동 확인: 주요 API 요청 흐름을 따라 인증/인가 체크 위치 확인
