# 가입 기능 추가 계획

## 배경/문제
- 현재 로그인은 인메모리 사용자 한 명으로 고정되어 있어 실제 사용자 가입 흐름이 없다.
- 사용자별 데이터(스레드/카테고리)가 소유자 기반으로 설계되어 있으나 계정 생성 경로가 없다.

## 목표
- 사용자가 아이디/비밀번호로 가입하고 즉시 로그인할 수 있는 흐름을 제공한다.
- 가입 후 생성되는 계정이 기존 인증/권한 흐름과 자연스럽게 연동된다.

## 범위
- 포함: 백엔드 가입 API, 사용자 저장소/엔티티, 비밀번호 해시, 프론트 가입 UI와 API 연동, 기본 검증 및 오류 처리.
- 제외: 이메일 인증, 소셜 로그인, 비밀번호 재설정/찾기, 관리자 관리 UI.

## 현재 동작 정리
- 백엔드는 Spring Security 인메모리 사용자(고정 계정)만 제공한다.
- 로그인 API(`/api/auth/login`)는 세션 기반으로 동작하고 `AuthSupport`로 인증을 확인한다.
- 프론트는 홈 화면에서 로그인 폼만 제공한다.

## 개선 방향
- 사용자 엔티티 및 저장소를 추가해 영속 사용자 기반으로 전환한다.
- 가입 API는 중복 아이디를 방지하고 안전한 비밀번호 해시를 저장한다.
- 프론트는 로그인 화면에 가입 플로우를 추가해 사용자가 쉽게 전환할 수 있도록 한다.

## 단계별 계획
- Step 1: 백엔드 사용자 모델/저장소 추가
  - 무엇을 변경: `UserEntity`/`UserRepository` 추가, Security 설정을 사용자 기반으로 전환.
  - 완료 기준: 신규 사용자 조회가 가능하고 기존 로그인 흐름이 사용자 저장소를 사용.
- Step 2: 가입 API 추가
  - 무엇을 변경: `/api/auth/signup` 엔드포인트 및 요청/응답 DTO, 중복 검사와 비밀번호 해시 처리.
  - 완료 기준: 유효한 요청으로 사용자 생성되고 중복 아이디는 적절히 실패 응답.
- Step 3: 프론트 가입 UI/연동
  - 무엇을 변경: 로그인 화면에 가입 폼/탭 추가, 가입 API 호출 후 자동 로그인 또는 로그인 유도.
  - 완료 기준: 브라우저에서 가입 요청이 성공하고 로그인 상태로 전환.
- Step 4: 오류 메시지/검증 보강
  - 무엇을 변경: 필수 입력값 검증 메시지, 실패 시 사용자 친화 메시지.
  - 완료 기준: 잘못된 입력에서 오류가 명확히 표시.

## 리스크 및 대응
- 중복 아이디 처리 누락으로 데이터 충돌 가능 → 가입 시 유니크 제약 및 사전 검사 추가.
- 비밀번호 저장 보안 문제 → Spring `PasswordEncoder` 사용해 해시 저장.
- 기존 인메모리 계정 제거 시 개발 테스트 영향 → 로컬 환경 기본 계정 생성 방법 문서화.

## 검증 계획
- API: 가입 성공/중복 실패/필수값 누락 케이스를 수동 호출로 확인.
- UI: 가입 후 로그인 상태 전환, 새 계정으로 데이터 생성 가능 여부 확인.
- 회귀: 기존 로그인/로그아웃 및 인증 필요 API 호출이 정상 동작하는지 확인.
