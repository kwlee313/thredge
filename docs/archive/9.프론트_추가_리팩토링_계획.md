# 프론트 추가 리팩토링 계획

## 배경/문제
- HomeFeed/ThreadDetailPage에 react-query 뮤테이션/쿼리 패턴이 유사하게 반복된다.
- HomeFeed 안에 카테고리 필터/카운트/삭제 UI가 길게 결합되어 읽기 어렵다.
- 스레드/엔트리 렌더링이 큰 컴포넌트에 포함되어 변경 영향 범위가 크다.
- 날짜 필터 UI와 포맷/이동 로직이 한 블록에 섞여 있다.
- App과 HomePage에서 auth 상태 조회가 중복되어 네트워크 호출 및 상태 일관성 이슈 가능성이 있다.

## 목표
- 공통 쿼리/뮤테이션 로직을 훅으로 분리해 중복을 제거한다.
- 카테고리/날짜/카드 UI를 컴포넌트로 나누어 단일 책임을 강화한다.
- 인증 상태를 상위에서 단일 소스로 관리한다.

## 범위
- 포함: `frontend/src/components/home/HomeFeed.tsx`, `frontend/src/routes/ThreadDetailPage.tsx`, `frontend/src/App.tsx`, `frontend/src/routes/HomePage.tsx` 분리
- 포함: 공통 훅/컴포넌트 신규 추가
- 제외: 디자인 변경, 기능 추가, API 변경, 테스트 프레임워크 추가

## 현재 동작 정리
- HomeFeed/ThreadDetailPage에 동일 뮤테이션(핀/숨김/수정/카테고리 추가 등)이 각각 존재.
- 카테고리 필터/카운트/삭제 UI가 HomeFeed 내부에 결합.
- 스레드 카드/엔트리 카드 렌더링이 큰 블록으로 존재.
- 날짜 필터 UI/로직이 HomeFeed 안에 포함.
- App, HomePage 모두 `fetchMe` 사용.

## 개선 방향
- 공통 데이터 액션은 `useThreadActions`와 같은 훅으로 추출.
- 큰 UI 덩어리는 역할별 컴포넌트로 분리하고 props는 최소화.
- 날짜/카테고리 관련 로직은 전용 컴포넌트 혹은 훅으로 캡슐화.
- 인증 상태는 App에서 가져와 하위로 전달.

## 단계별 계획
- 단계 1: 공통 쿼리/뮤테이션 훅 분리
  - 변경: HomeFeed/ThreadDetailPage에서 반복되는 쿼리/뮤테이션을 훅으로 이동
  - 완료 기준: 중복 제거, 각 페이지는 훅을 호출해 사용
- 단계 2: 카테고리 필터/카운트 UI 분리
  - 변경: HomeFeed 내 카테고리 섹션을 `CategoryFilterBar` 컴포넌트로 분리
  - 완료 기준: HomeFeed에서 카테고리 렌더 블록 제거
- 단계 3: 날짜 필터 UI 분리
  - 변경: 날짜 컨트롤을 `DateFilter` 컴포넌트 또는 `useDateFilter` 훅으로 분리
  - 완료 기준: HomeFeed에서 날짜 관련 로직 최소화
- 단계 4: 스레드/엔트리 카드 분리
  - 변경: `ThreadCard`, `EntryCard`, `ReplyComposer` 등으로 분리
  - 완료 기준: HomeFeed 렌더링 로직 축소, 컴포넌트 재사용 가능
- 단계 5: 인증 상태 단일화
  - 변경: App에서 auth 상태를 관리하고 HomePage/하위에 전달
  - 완료 기준: `fetchMe` 호출 단일화

## 리스크 및 대응
- 리스크: 컴포넌트 분리로 props 전달 증가
  - 대응: 필요한 값만 전달하고 훅으로 상태를 묶어 관리
- 리스크: 캐시 업데이트 경로 변경으로 UI 반영 타이밍 변동
  - 대응: 쿼리 키/무효화 경로를 명확히 유지

## 검증 계획
- 수동 검증
  - Home: 로그인/로그아웃, 스레드 작성/편집/핀/숨김, 카테고리 필터/삭제, 날짜 필터, 검색
  - ThreadDetail: 스레드 수정/핀/숨김, 엔트리 작성/편집/답글
- 간단 확인
  - 콘솔 에러 없음
  - 네비게이션 정상 동작
